# 《PPT 截图文字可编辑化 MVP 需求文档（PRD）》

## 1. 背景与问题定义
当前用户在自研 Web 编辑器中导入 PPT 页面截图（PNG/JPEG）后，无法直接修改图片内的文字内容。目标是提供“图片文字抓取与可编辑化”能力：用户点选图片中的某段文字，即可将其转换为可编辑文本对象，同时自动擦除原图中的文字并补齐背景，使用户能够像编辑原生文本一样修改内容与样式。

## 2. 目标与成功标准
### 2.1 产品目标
- 支持对 **PPT 页面截图**中的文字进行识别、选择、转换为可编辑文本对象。
- 转换后 **原图文字被抹除**，背景补齐自然，编辑体验可闭环（可改字、可移动、可改样式）。
- 支持保存为项目数据（JSON），并可导出渲染结果（至少 PNG）。

### 2.2 MVP 成功标准（验收口径）
- 在典型 PPT 截图样本集上：
  - OCR 文本块可被正确框选显示，点击转换后生成可编辑文本对象。
  - 转换区域的“残影/边缘脏/背景破坏”问题在大多数简单背景下可接受（见质量指标）。
- 交互端到端闭环完成：导入 → 识别 → 选择 → 转可编辑 → 编辑 → 保存/导出。

### 2.3 质量指标（MVP）
- **可用性**：用户在单页截图上完成 10 处文本替换，成功率 ≥ 80%（成功=用户无需复杂手动修复即可得到可接受结果）。
- **背景修复可接受率**（简单背景：纯色、线性渐变、轻纹理）≥ 85%。
- **时延**（单页 1920×1080）：
  - OCR 分析：P95 ≤ 3s（受云 OCR 影响）
  - 单文本块 patch 生成：P95 ≤ 600ms（ROI 级处理）

## 3. 用户与使用场景
- 典型用户：需要在 Web 端快速改 PPT 截图内容的产品/运营/研发（制作演示材料、复用模板、快速出图）。
- 场景：
  - 改标题、改数据、改条目描述
  - 中英文混排（MVP 支持；质量以英文/数字优先）

## 4. 范围界定
### 4.1 MVP 交付范围（In Scope）
1) **导入图片**：上传或粘贴导入单页 PPT 截图（PNG/JPEG）。  
2) **OCR 分析**：生成“文字候选框”覆盖层（可 hover 高亮）。  
3) **点选转换**：点击某候选框 → 自动生成 patch（抹字+补背景）→ 在同位置生成可编辑文本对象。  
4) **编辑能力**：  
   - 修改文本内容（必选）
   - 拖动位置、旋转（可选；若 quad 有旋转则至少支持保持旋转角）
   - 基础样式：字号、颜色、粗细（最小集）
5) **撤销/重做**：对转换与编辑操作支持 undo/redo（至少 20 步）。  
6) **保存/加载**：保存项目 JSON（包含原图引用、layers、patch 列表），可重新打开继续编辑。  
7) **导出**：导出当前画布渲染为 PNG（前端合成或后端渲染二选一）。  

### 4.2 不做（Out of Scope）
- 自动还原 PPT 原始字体（精确 font family 匹配）、复杂特效（描边、发光、3D、纹理填充）的一键复刻。
- 多页 PPT 文件解析（仅处理单页截图）。
- 复杂背景（大面积照片、强结构纹理）的高质量修复（MVP 允许失败回退）。
- 批量“一键全页转可编辑”默认关闭（可作为实验开关）。

## 5. 关键用户流程（User Journey）
### 5.1 流程 A：单块文字替换（主路径）
1. 用户导入截图 → 画布显示图片。  
2. 系统自动 OCR → 显示候选文字框（lines 级）。  
3. 用户点击某候选框 → 系统生成 patch 并创建文本对象。  
4. 用户输入新文字 → 即时预览。  
5. 用户保存或导出 PNG。  

### 5.2 流程 B：OCR 识别有误的处理（MVP 低成本）
- 点击转换后，文本框内显示 OCR 结果；用户可手动改正。
- 若某块识别极差：用户可框选区域并触发“对选区重新 OCR”（可选增强功能，默认隐藏在更多菜单）。

## 6. 功能需求详述
### 6.1 导入与页面管理
- 支持上传 PNG/JPEG；限制单图大小（例如 ≤ 10MB）。
- 生成 page_id，保留原图 URL（对象存储）。

### 6.2 OCR 候选框
- 候选框粒度：默认 **line**（行），显示为四边形 quad。
- hover 高亮、点击选中。
- 显示置信度低的候选（例如 <0.7）为“虚线/弱提示”（具体 UI 由你们风格决定）。

### 6.3 转换为可编辑（Convert to Editable）
- 点击后进入“转换中”状态；成功后：
  - 新增 patch layer（透明 PNG，仅覆盖文字 ROI）
  - 新增 text layer（可编辑）
- 若 patch 生成失败：
  - 仍创建 text layer（可编辑），但不抹原字；提示用户“背景修复失败，可重试/切换模式”。

### 6.4 文本编辑能力（MVP 最小集）
- 内容编辑（必选）
- 字号、颜色、粗细（必选）
- 对齐（可选：左/中/右）
- 旋转：若 OCR quad 有角度，文本对象需按该角度渲染（必选）

### 6.5 撤销/重做
- 转换操作、文本编辑、移动/缩放/旋转均入栈。

### 6.6 保存/加载/导出
- 保存：项目 JSON（引用原图、patch 资源、layers、历史可选不存）。
- 导出 PNG：
  - MVP 可采用前端 canvas 合成（背景图 + patch 层 + 文本层）。
  - 或后端渲染（若前端渲染与线上一致性难保证）。

## 7. 失败与降级策略
- OCR 超时/失败：提示重试；允许用户仍手动添加文本层（不依赖 OCR）。
- patch 失败：不抹原字，仅创建文本层；提供“重新生成 patch（切换模式）”入口。
- 低置信识别：不自动转 editable（仅标注），由用户主动点击确认。

## 8. 埋点与观测（MVP）
- OCR 成功率、耗时、候选数量分布
- convert 成功率、patch 成功率、patch 耗时
- 用户修改 OCR 文本的比例（衡量 OCR 质量）
- 导出成功率、导出耗时
