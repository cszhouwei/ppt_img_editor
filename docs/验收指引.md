# PPT 截图文字可编辑化工具 - 验收指引

## 项目开发进度总览

### 已完成的 Milestones

- ✅ **Milestone 1**: 基础骨架与存储
- ✅ **Milestone 2**: Mock OCR 和 Page 管理
- ✅ **Milestone 3**: Patch Pipeline (核心功能)
- ✅ **Milestone 4**: 文本层编辑与保存
- ✅ **Milestone 5**: 导出功能
- ✅ **Milestone 6**: 真实 OCR 接入 (Azure + Google Cloud Vision)
- ✅ **Milestone 7**: 前端实现 + UI 增强

### 代码统计

**后端 (FastAPI)**
- Python 文件数: 33 个
- 代码总行数: 3,188 行
- 主要模块:
  - API 路由: 4 个文件 (health, assets, pages, projects)
  - OCR 提供商: 4 个文件 (base, mock, azure, google)
  - 数据模型: 5 个文件 (base, page, candidate, patch, project)
  - Patch 处理: 6 个文件 (pipeline, geometry, mask, inpaint, bg_fit, compose)
  - 工具函数: 4 个文件 (image, hash, export, text_style)

**前端 (React + TypeScript)**
- 源文件数: 12 个
- 代码总行数: 1,464 行
- 主要模块:
  - 组件: 5 个 (ImageUploader, EditorCanvas, TextEditor, LayerPanel, Toolbar)
  - 状态管理: 1 个 (useEditorStore.ts)
  - API 服务: 1 个 (api.ts)
  - 类型定义: 1 个 (index.ts)
  - 样式: 2 个 (App.css, index.css)

**Git 提交历史**
- 总提交数: 11 个
- 最新提交: feat: Add frontend UI enhancements - text editing, layers, save/export

---

## 一、环境准备

### 1.1 前置要求

- Docker >= 20.10
- Docker Compose >= 2.0
- Node.js >= 18.0 (用于前端开发)
- Make (可选,但推荐)

### 1.2 配置环境变量

```bash
cd /Users/bytedance/Downloads/projects/ppt_img_editor
cp .env.example .env
```

编辑 `.env` 文件,配置以下关键参数:

```bash
# 基础配置
SERVICE_PORT=8080
BASE_URL=http://localhost:8080

# MinIO 配置
S3_ENDPOINT=minio:9000
S3_PUBLIC_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET=doc-edit

# Postgres 配置
POSTGRES_DSN=postgresql://ppteditor:ppteditor123@postgres:5432/ppt_editor

# OCR 配置 (可选)
OCR_PROVIDER=mock  # 可选: mock, azure, google

# Azure OCR (如需使用)
AZURE_VISION_ENDPOINT=https://your-resource.cognitiveservices.azure.com/
AZURE_VISION_KEY=your-azure-key

# Google Cloud Vision (如需使用)
GOOGLE_CREDENTIALS_PATH=/path/to/service-account.json
# 或
GOOGLE_CREDENTIALS_JSON={"type":"service_account",...}
```

---

## 二、后端验收

### 2.1 启动后端服务

```bash
# 启动所有 Docker 服务
make dev
# 或
docker-compose up -d

# 等待服务启动 (约 10-15 秒)
sleep 15

# 检查服务状态
docker-compose ps
```

**预期结果**: 所有服务状态为 `healthy` 或 `running`
- postgres
- minio
- doc_process

### 2.2 健康检查

```bash
curl http://localhost:8080/health
```

**预期响应**:
```json
{
  "status": "ok",
  "service": "doc_process",
  "version": "0.1.0",
  "storage": "connected",
  "database": "connected"
}
```

### 2.3 API 文档验证

访问 Swagger UI:
```
http://localhost:8080/docs
```

**预期结果**:
- 页面正常加载
- 显示所有 12 个 API 端点
- 可以展开查看每个端点的详细信息

### 2.4 MinIO 存储验证

访问 MinIO 控制台:
```
http://localhost:9001
```

登录信息:
- Username: `minioadmin`
- Password: `minioadmin`

**预期结果**:
- 成功登录
- 看到 `doc-edit` bucket 已存在
- bucket 内包含 `assets/`, `patches/`, `exports/` 目录

### 2.5 完整工作流验证

#### Step 1: 上传图片

```bash
curl -X POST http://localhost:8080/v1/assets/upload \
  -F "file=@testdata/images/sample_slide.png" \
  | python3 -m json.tool > /tmp/upload_response.json

cat /tmp/upload_response.json
```

**预期响应**:
```json
{
  "asset_id": "ast_xxxxxxxxxx",
  "image_url": "http://localhost:9000/doc-edit/assets/ast_xxx.png",
  "width": 1920,
  "height": 1080,
  "sha256": "abc123..."
}
```

保存 `asset_id` 和 `image_url` 用于后续步骤。

#### Step 2: 创建 Page

```bash
# 替换为实际的 image_url
IMAGE_URL="http://localhost:9000/doc-edit/assets/ast_xxx.png"

curl -X POST http://localhost:8080/v1/pages \
  -H "Content-Type: application/json" \
  -d "{\"image_url\":\"$IMAGE_URL\",\"width\":1920,\"height\":1080}" \
  | python3 -m json.tool > /tmp/page_response.json

cat /tmp/page_response.json
```

**预期响应**:
```json
{
  "page_id": "page_xxxxxxxxxx",
  "image_url": "http://localhost:9000/doc-edit/assets/ast_xxx.png",
  "width": 1920,
  "height": 1080,
  "created_at": "2025-12-29T..."
}
```

保存 `page_id` 用于后续步骤。

#### Step 3: OCR 分析 (Mock)

```bash
# 替换为实际的 page_id
PAGE_ID="page_xxxxxxxxxx"

curl -X POST http://localhost:8080/v1/pages/$PAGE_ID/analyze \
  -H "Content-Type: application/json" \
  -d '{"provider":"mock","lang_hints":["zh-Hans","en"]}' \
  | python3 -m json.tool > /tmp/analyze_response.json

cat /tmp/analyze_response.json
```

**预期响应**:
```json
{
  "page_id": "page_xxx",
  "provider": "mock",
  "candidates": [
    {
      "id": "cand_xxx",
      "text": "示例文本",
      "confidence": 0.95,
      "quad": [[x1,y1],[x2,y2],[x3,y3],[x4,y4]],
      "bbox": {"x": 100, "y": 200, "w": 300, "h": 50},
      "angle_deg": 0.0
    }
  ],
  "candidate_count": 5
}
```

保存第一个 `candidate.id` 用于后续步骤。

#### Step 4: 生成 Patch

```bash
CANDIDATE_ID="cand_xxx"

curl -X POST http://localhost:8080/v1/pages/$PAGE_ID/patch \
  -H "Content-Type: application/json" \
  -d "{\"candidate_id\":\"$CANDIDATE_ID\"}" \
  | python3 -m json.tool > /tmp/patch_response.json

cat /tmp/patch_response.json
```

**预期响应**:
```json
{
  "patch": {
    "id": "patch_xxx",
    "page_id": "page_xxx",
    "candidate_id": "cand_xxx",
    "quad": [[x1,y1],[x2,y2],[x3,y3],[x4,y4]],
    "bbox": {"x": 100, "y": 200, "w": 300, "h": 50},
    "patch_url": "http://localhost:9000/doc-edit/patches/patch_xxx.png",
    "bg_type": "solid",
    "bg_color": "#ffffff",
    "created_at": "2025-12-29T..."
  }
}
```

验证 `patch_url` 可访问:
```bash
curl -I http://localhost:9000/doc-edit/patches/patch_xxx.png
# 预期: HTTP/1.1 200 OK
```

#### Step 5: 估计文本样式

```bash
curl -X POST http://localhost:8080/v1/pages/$PAGE_ID/estimate-style \
  -H "Content-Type: application/json" \
  -d "{\"candidate_id\":\"$CANDIDATE_ID\"}" \
  | python3 -m json.tool > /tmp/style_response.json

cat /tmp/style_response.json
```

**预期响应**:
```json
{
  "style": {
    "fontSize": 24,
    "fontWeight": 600,
    "fill": "rgba(0,0,0,1)"
  }
}
```

#### Step 6: 创建项目

```bash
curl -X POST http://localhost:8080/v1/projects \
  -H "Content-Type: application/json" \
  -d @- <<EOF | python3 -m json.tool > /tmp/project_response.json
{
  "page": {
    "page_id": "$PAGE_ID",
    "image_url": "$IMAGE_URL",
    "width": 1920,
    "height": 1080
  },
  "layers": [
    {
      "kind": "patch",
      "id": "patch_xxx",
      "patch_url": "http://localhost:9000/doc-edit/patches/patch_xxx.png",
      "quad": [[100,200],[400,200],[400,250],[100,250]],
      "bbox": {"x": 100, "y": 200, "w": 300, "h": 50}
    },
    {
      "kind": "text",
      "id": "text_001",
      "text": "编辑后的文本",
      "quad": [[100,200],[400,200],[400,250],[100,250]],
      "style": {
        "fontSize": 24,
        "fontWeight": 600,
        "fill": "rgba(0,0,0,1)"
      }
    }
  ]
}
EOF

cat /tmp/project_response.json
```

**预期响应**:
```json
{
  "project_id": "proj_xxx",
  "page": {...},
  "layers": [...],
  "created_at": "2025-12-29T...",
  "updated_at": "2025-12-29T..."
}
```

保存 `project_id` 用于后续步骤。

#### Step 7: 导出 PNG

```bash
PROJECT_ID="proj_xxx"

curl -X POST http://localhost:8080/v1/projects/$PROJECT_ID/export/png \
  | python3 -m json.tool > /tmp/export_response.json

cat /tmp/export_response.json
```

**预期响应**:
```json
{
  "export_url": "http://localhost:9000/doc-edit/exports/export_xxx.png"
}
```

下载导出的图片:
```bash
curl -o /tmp/exported.png http://localhost:9000/doc-edit/exports/export_xxx.png

# 在 macOS 上预览
open /tmp/exported.png
```

**预期结果**:
- 图片正常显示
- 原文字区域已被 patch 覆盖
- 新文本已渲染到图片上

### 2.6 OCR 提供商验证 (可选)

#### Azure OCR 验证

前置条件:
- 已在 Azure 创建 Computer Vision 资源
- 已配置 `AZURE_VISION_ENDPOINT` 和 `AZURE_VISION_KEY`

```bash
curl -X POST http://localhost:8080/v1/pages/$PAGE_ID/analyze \
  -H "Content-Type: application/json" \
  -d '{"provider":"azure","lang_hints":["zh-Hans","en"]}' \
  | python3 -m json.tool
```

**预期响应**: 返回真实的 OCR 识别结果

#### Google Cloud Vision 验证

前置条件:
- 已创建 Google Cloud 项目并启用 Vision API
- 已配置 `GOOGLE_CREDENTIALS_PATH` 或 `GOOGLE_CREDENTIALS_JSON`

```bash
curl -X POST http://localhost:8080/v1/pages/$PAGE_ID/analyze \
  -H "Content-Type: application/json" \
  -d '{"provider":"google","lang_hints":["zh-Hans","en"]}' \
  | python3 -m json.tool
```

**预期响应**: 返回真实的 OCR 识别结果

---

## 三、前端验收

### 3.1 安装依赖

```bash
cd apps/web
npm install
```

**预期结果**:
- 所有依赖包安装成功
- 生成 `node_modules` 目录
- 生成 `package-lock.json` 文件

### 3.2 启动前端开发服务器

```bash
npm run dev
```

**预期输出**:
```
VITE v5.0.8  ready in 500 ms

➜  Local:   http://localhost:3000/
➜  Network: use --host to expose
➜  press h to show help
```

### 3.3 访问前端应用

打开浏览器访问:
```
http://localhost:3000
```

### 3.4 前端功能验收

#### 功能点 1: 图片上传

**操作步骤**:
1. 看到主页标题 "PPT 截图文字编辑器"
2. 看到上传区域 (虚线框)
3. 点击上传区域选择图片,或将图片拖拽到上传区域
4. 选择 `testdata/images/sample_slide.png` 或任意 PPT 截图

**预期结果**:
- 显示加载动画 (转圈 + "上传图片中...")
- 上传成功后自动跳转到编辑界面
- 编辑界面显示三栏布局:
  - 左侧: 图层面板 (Layer Panel)
  - 中间: 画布 (Canvas)
  - 右侧: 文本编辑器 (Text Editor)
- 顶部显示工具栏 (Toolbar)

#### 功能点 2: OCR 结果可视化

**预期结果**:
- 中间画布显示上传的图片
- 图片上叠加绿色半透明矩形框 (OCR 识别的文字区域)
- 每个矩形框标注文字内容
- 鼠标悬停时矩形框高亮

#### 功能点 3: 交互式选择

**操作步骤**:
1. 点击任意一个绿色矩形框

**预期结果**:
- 被点击的矩形框变为红色 (选中状态)
- 其他矩形框保持绿色
- 显示加载动画 "生成 Patch 和文本图层中..."
- 加载完成后:
  - 左侧图层面板新增 2 个图层:
    - 🖼️ Patch 图层 (显示尺寸)
    - 📝 文本图层 (显示文字片段)
  - 右侧文本编辑器显示该文字的编辑界面

#### 功能点 4: 文本编辑

**预期显示**:
- 文本内容 (textarea)
- 字号滑块 (12-72px)
- 字重下拉框 (Normal 400 / SemiBold 600 / Bold 700)
- 颜色选择器 (color input + hex 显示)
- "应用更改" 按钮

**操作步骤**:
1. 修改文本内容
2. 调整字号到 36
3. 选择字重 Bold 700
4. 修改颜色为红色 (#ff0000)
5. 点击 "应用更改"

**预期结果**:
- 左侧图层面板中对应文本图层的预览更新
- 状态已保存到内存中 (可在导出时体现)

#### 功能点 5: 图层管理

**预期显示**:
- 左侧面板显示 "图层管理"
- 列出所有图层,每个图层显示:
  - 类型图标 (📝 或 🖼️)
  - 图层名称/预览
  - 删除按钮 (×)

**操作步骤**:
1. 点击某个图层的删除按钮
2. 确认删除提示

**预期结果**:
- 图层从列表中移除
- 如果删除的是当前选中的文本图层,右侧文本编辑器显示 "点击候选框开始编辑"

#### 功能点 6: 保存项目

**操作步骤**:
1. 点击顶部工具栏的 "💾 保存项目" 按钮

**预期结果**:
- 显示加载动画 "保存项目中..."
- 保存成功后弹出提示框:
  - 如果是首次保存: "项目已创建! ID: proj_xxx"
  - 如果是更新保存: "项目已保存!"
- 工具栏左侧显示 "项目: proj_xxx"

#### 功能点 7: 导出 PNG

**操作步骤**:
1. 确保项目已保存 (工具栏显示项目 ID)
2. 点击 "📥 导出 PNG" 按钮

**预期结果**:
- 显示加载动画 "导出 PNG 中..."
- 导出成功后:
  - 浏览器自动下载 PNG 文件 (`export_xxx.png`)
  - 工具栏下方显示绿色提示 "✅ 导出成功! [查看图片]"
- 点击 "查看图片" 链接在新标签页打开导出的图片

**图片验证**:
- 原文字区域已被 patch 覆盖 (背景修复)
- 编辑后的文字已渲染到图片上
- 文字样式 (颜色、字号、字重) 符合编辑器中的设置

#### 功能点 8: 重新开始

**操作步骤**:
1. 点击 "重新开始" 按钮
2. 确认提示 "确定要重新开始吗? 未保存的更改将丢失。"

**预期结果**:
- 返回到上传页面
- 所有状态清空 (图层、项目、候选框等)

### 3.5 响应式布局验证

**操作步骤**:
1. 调整浏览器窗口大小

**预期结果**:
- 左右侧边栏宽度固定 (250px / 300px)
- 中间画布区域自适应宽度
- 垂直滚动条在需要时出现
- 布局不崩溃

### 3.6 错误处理验证

#### 未保存直接导出

**操作步骤**:
1. 上传图片并选择候选框
2. 不保存项目,直接点击 "导出 PNG"

**预期结果**:
- 弹出提示 "请先保存项目"
- 不执行导出操作

#### 网络错误

**操作步骤**:
1. 停止后端服务: `docker-compose stop doc_process`
2. 尝试上传图片

**预期结果**:
- 显示错误提示 (alert 或其他形式)
- 不崩溃,可以重试

---

## 四、集成测试

### 4.1 完整用户流程

**场景**: 用户从零开始编辑一张 PPT 截图

**步骤**:
1. 访问 http://localhost:3000
2. 上传图片 `testdata/images/sample_slide.png`
3. 等待 OCR 分析完成
4. 点击第一个文字候选框
5. 等待 Patch 和文本图层生成
6. 在右侧文本编辑器中:
   - 将文字改为 "已编辑"
   - 字号改为 48
   - 颜色改为蓝色 (#0000ff)
7. 点击 "应用更改"
8. 点击第二个文字候选框
9. 同样编辑第二个文字
10. 点击 "保存项目"
11. 记录项目 ID
12. 点击 "导出 PNG"
13. 下载并查看导出的图片
14. 验证两处文字都已修改

**预期结果**:
- 全流程无错误
- 导出的图片符合预期
- 耗时 < 30 秒 (取决于图片大小和 OCR 速度)

### 4.2 项目持久化验证

**步骤**:
1. 完成上述流程并记录项目 ID: `proj_xxx`
2. 点击 "重新开始"
3. 使用 API 加载项目:
   ```bash
   curl http://localhost:8080/v1/projects/proj_xxx | python3 -m json.tool
   ```
4. 验证返回的项目数据包含之前编辑的内容

**预期结果**:
- 项目数据已正确保存到数据库
- 包含所有图层 (patch + text)
- 文本内容和样式符合编辑结果

---

## 五、性能验证

### 5.1 上传速度

**测试**:
- 上传 1920x1080 PNG 图片 (约 1-2MB)

**预期**: < 3 秒

### 5.2 OCR 分析速度

**测试**:
- Mock OCR: < 1 秒
- Azure OCR: < 5 秒
- Google OCR: < 5 秒

### 5.3 Patch 生成速度

**测试**:
- 单个 Patch 生成

**预期**: < 2 秒

### 5.4 导出速度

**测试**:
- 导出包含 5 个图层的项目

**预期**: < 5 秒

---

## 六、常见问题排查

### 问题 1: Docker 服务启动失败

**症状**: `docker-compose ps` 显示服务 unhealthy

**排查步骤**:
```bash
# 查看服务日志
docker-compose logs doc_process
docker-compose logs postgres
docker-compose logs minio

# 检查端口占用
lsof -i :8080
lsof -i :5432
lsof -i :9000
```

**常见原因**:
- 端口被占用 → 修改 docker-compose.yml 中的端口映射
- 依赖缺失 → 重新构建镜像: `docker-compose build doc_process`
- 环境变量错误 → 检查 `.env` 文件

### 问题 2: 前端无法连接后端

**症状**: 上传图片时出现网络错误

**排查步骤**:
```bash
# 检查后端是否正常运行
curl http://localhost:8080/health

# 检查前端 Vite 配置的代理
cat apps/web/vite.config.ts
```

**解决方案**:
- 确保后端服务在 8080 端口运行
- 确保 Vite 代理配置正确: `/api` → `http://localhost:8080`

### 问题 3: OCR 分析返回空结果

**症状**: 上传图片后没有候选框显示

**排查步骤**:
```bash
# 检查 OCR provider 配置
echo $OCR_PROVIDER  # 应该是 mock

# 手动测试 OCR API
curl -X POST http://localhost:8080/v1/pages/$PAGE_ID/analyze \
  -H "Content-Type: application/json" \
  -d '{"provider":"mock","lang_hints":["zh-Hans","en"]}'
```

**解决方案**:
- Mock OCR 使用随机数据生成,确保 `testdata/ocr_mock/` 目录存在
- 检查后端日志是否有错误

### 问题 4: 导出的图片显示不正常

**症状**: 导出的图片上文字位置错误或样式不对

**排查步骤**:
```bash
# 检查导出日志
docker-compose logs doc_process | grep export

# 手动查看导出文件
curl -I http://localhost:9000/doc-edit/exports/export_xxx.png
```

**常见原因**:
- 字体缺失 → 检查 Dockerfile 中是否安装了 DejaVu Sans 字体
- Quad 坐标错误 → 检查前端传递的 layer 数据格式

### 问题 5: MinIO 无法访问

**症状**: 图片 URL 返回 403 或 404

**排查步骤**:
```bash
# 检查 MinIO 服务
docker-compose logs minio

# 检查 bucket 是否存在
docker-compose exec minio mc ls minio/doc-edit

# 检查 bucket 权限
docker-compose exec minio mc policy get minio/doc-edit
```

**解决方案**:
- 重新运行 minio-init: `docker-compose restart minio-init`
- 手动设置 bucket 为 public: `docker-compose exec minio mc policy set public minio/doc-edit`

---

## 七、验收清单

### 后端功能 (12/12)

- [ ] GET /health - 健康检查
- [ ] POST /v1/assets/upload - 图片上传
- [ ] POST /v1/pages - 创建 page
- [ ] GET /v1/pages/{id}/candidates - 获取候选框
- [ ] POST /v1/pages/{id}/analyze - OCR 分析 (Mock)
- [ ] POST /v1/pages/{id}/analyze - OCR 分析 (Azure)
- [ ] POST /v1/pages/{id}/analyze - OCR 分析 (Google)
- [ ] POST /v1/pages/{id}/patch - 生成 Patch
- [ ] POST /v1/pages/{id}/estimate-style - 估计样式
- [ ] POST /v1/projects - 创建项目
- [ ] GET /v1/projects/{id} - 获取项目
- [ ] PUT /v1/projects/{id} - 更新项目
- [ ] DELETE /v1/projects/{id} - 删除项目
- [ ] POST /v1/projects/{id}/export/png - 导出 PNG

### 前端功能 (8/8)

- [ ] 图片上传 (支持点击和拖拽)
- [ ] OCR 结果可视化 (Canvas 渲染)
- [ ] 交互式候选框选择
- [ ] 自动生成 Patch 和文本图层
- [ ] 文本内容和样式编辑
- [ ] 图层列表和删除
- [ ] 项目保存 (创建/更新)
- [ ] PNG 导出和下载

### 基础设施 (5/5)

- [ ] Docker Compose 环境正常运行
- [ ] PostgreSQL 数据库连接正常
- [ ] MinIO 对象存储访问正常
- [ ] 所有环境变量正确配置
- [ ] 网络和端口映射正常

### 代码质量 (4/4)

- [ ] 所有 Git 提交历史清晰
- [ ] README 文档完整
- [ ] 代码结构清晰,符合最佳实践
- [ ] 无明显的代码冗余或错误

---

## 八、后续建议

### 8.1 功能增强

1. **前端优化**
   - 实现文本图层的拖拽调整位置
   - 添加撤销/重做功能
   - 支持批量选择和编辑
   - 添加图层顺序调整 (上移/下移)

2. **性能优化**
   - 大图片缩略图显示
   - 懒加载和虚拟滚动
   - OCR 结果缓存
   - 导出进度条

3. **用户体验**
   - 更友好的错误提示 (Toast 通知)
   - 快捷键支持
   - 项目历史记录
   - 批量导出

### 8.2 测试覆盖

1. **单元测试**
   - 后端: 覆盖核心函数 (Patch 生成、样式估计、导出)
   - 前端: 覆盖关键组件和状态管理

2. **集成测试**
   - E2E 测试完整用户流程
   - API 集成测试

3. **性能测试**
   - 大文件上传 (>10MB)
   - 高并发请求
   - 复杂项目导出 (>20 图层)

### 8.3 部署准备

1. **生产环境配置**
   - HTTPS 支持
   - 环境变量管理 (使用 Secrets)
   - 日志聚合和监控
   - 备份策略

2. **CI/CD 流程**
   - GitHub Actions 自动测试
   - Docker 镜像自动构建
   - 自动部署到 Staging/Production

3. **文档完善**
   - API 文档 (OpenAPI/Swagger)
   - 用户手册
   - 开发者指南
   - 故障排查手册

---

## 附录

### A. 环境变量完整列表

```bash
# 服务配置
SERVICE_PORT=8080
BASE_URL=http://localhost:8080

# MinIO
S3_ENDPOINT=minio:9000
S3_PUBLIC_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET=doc-edit
S3_REGION=us-east-1

# Postgres
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=ppteditor
POSTGRES_PASSWORD=ppteditor123
POSTGRES_DB=ppt_editor
POSTGRES_DSN=postgresql://ppteditor:ppteditor123@postgres:5432/ppt_editor

# OCR
OCR_PROVIDER=mock

# Azure
AZURE_VISION_ENDPOINT=
AZURE_VISION_KEY=

# Google Cloud
GOOGLE_CREDENTIALS_PATH=
GOOGLE_CREDENTIALS_JSON=
```

### B. API 端点速查表

| 方法 | 端点 | 描述 |
|------|------|------|
| GET | /health | 健康检查 |
| POST | /v1/assets/upload | 上传图片 |
| POST | /v1/pages | 创建 page |
| GET | /v1/pages/{id}/candidates | 获取候选框 |
| POST | /v1/pages/{id}/analyze | OCR 分析 |
| POST | /v1/pages/{id}/patch | 生成 Patch |
| POST | /v1/pages/{id}/estimate-style | 估计样式 |
| POST | /v1/projects | 创建项目 |
| GET | /v1/projects/{id} | 获取项目 |
| PUT | /v1/projects/{id} | 更新项目 |
| DELETE | /v1/projects/{id} | 删除项目 |
| POST | /v1/projects/{id}/export/png | 导出 PNG |

### C. 快速命令参考

```bash
# 启动所有服务
make dev

# 停止所有服务
make down

# 查看日志
make logs

# 清理环境
make clean

# 重启后端服务
docker-compose restart doc_process

# 重新构建后端镜像
docker-compose build doc_process

# 查看数据库
docker-compose exec postgres psql -U ppteditor -d ppt_editor

# 查看 MinIO 文件
docker-compose exec minio mc ls minio/doc-edit

# 前端开发
cd apps/web
npm install
npm run dev

# 前端构建
cd apps/web
npm run build
```

---

**验收完成标准**: 所有清单项全部勾选 ✅

**预计验收时间**: 30-45 分钟

**联系方式**: 如有问题请查看项目 README 或相关文档
